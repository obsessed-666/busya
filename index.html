<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>–ü–æ–¥–∞—Ä–æ–∫ –¥–ª—è –ë—É—Å–∏</title>
<link href="https://fonts.googleapis.com/css2?family=Marck+Script&family=Merriweather:wght@400;500;700&family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
/* ---------- Reset & base ---------- */
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --safe-top:env(safe-area-inset-top,0px);
  --safe-bottom:env(safe-area-inset-bottom,0px);
  --accent:#ff4f7d;
  --soft:#fff3f8;
  --panel-w:96vw;
}
html,body{height:100%;width:100%;background:#020214;color:var(--soft);font-family:Montserrat,system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;-webkit-font-smoothing:antialiased}
img{display:block;max-width:100%;-webkit-user-drag:none;user-select:none}
button,[role="button"],.tap{touch-action:manipulation;-webkit-tap-highlight-color:transparent}
html,body{overflow:hidden} /* top-level page is controlled by our panels */

/* ---------- BACKGROUNDS ---------- */
.bg-mystic{position:fixed;inset:0;z-index:-60;pointer-events:none;background:#000}
.bg-mystic .forest{
  position:absolute;inset:0;background-image:url('forest.jpg');background-size:cover;background-position:center center;
  transform-origin:center center;will-change:transform;animation:forestBreath 14s ease-in-out infinite;
  filter:contrast(.9) saturate(.92);
}
@keyframes forestBreath{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}

/* living fog (3 layered moving blurs) */
.bg-mystic .fog{
  position:absolute;inset:-10%;pointer-events:none;mix-blend-mode:screen;filter:blur(54px);opacity:.24;
  background:radial-gradient(circle at 20% 30%, rgba(175,190,255,0.12), transparent 20%),
             radial-gradient(circle at 82% 66%, rgba(120,140,190,0.09), transparent 20%);
  animation:mistFloat 36s linear infinite;
}
.bg-mystic .fog.f2{filter:blur(72px);opacity:.16;animation-duration:44s}
.bg-mystic .fog.f3{filter:blur(34px);opacity:.12;animation-duration:50s}
@keyframes mistFloat{0%{transform:translateY(0)}50%{transform:translateY(-120px)}100%{transform:translateY(0)}}

/* ---------- INTRO (cat) ---------- */
.intro-panel{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:2200;padding:18px;transition:opacity .45s ease, transform .45s ease}
.intro-panel.hidden{opacity:0;transform:scale(.995);pointer-events:none}
.cat-frame{border-radius:18px;padding:8px;background:linear-gradient(180deg,#20161b,#0c0809);box-shadow:0 46px 160px rgba(0,0,0,.72);border:4px solid rgba(255,255,255,0.04);cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:10px;transition:transform .12s ease;z-index:2201}
.cat-frame:active{transform:translateY(2px)}
#cat{width:min(84vw,520px);aspect-ratio:3/4;object-fit:cover;border-radius:12px;display:block;box-shadow:0 18px 60px rgba(0,0,0,.6);animation:catPulse 3.8s ease-in-out infinite}
@keyframes catPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.03)}}
.hint{font-size:14px;padding:8px 12px;background:rgba(0,0,0,.14);border-radius:999px;color:rgba(255,255,255,.94)}

/* ---------- STORY PANEL - with living fog and cinematic vibe ---------- */
.story-panel{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(var(--panel-w),920px);height:86vh;max-height:calc(100dvh - var(--safe-top) - var(--safe-bottom) - 40px);border-radius:14px;box-shadow:0 42px 160px rgba(0,0,0,.7);display:none;z-index:2100;overflow:hidden}
.story-panel.open{display:block}
.story-bg{position:absolute;inset:0;z-index:2;pointer-events:none;background:linear-gradient(180deg, rgba(6,8,12,0.88), rgba(2,3,6,0.96));}
.story-bg .glow{position:absolute;inset:-20%;filter:blur(68px);mix-blend-mode:screen;opacity:.18;background:radial-gradient(circle at 18% 24%, rgba(160,170,210,.12), transparent 22%);animation:glowMove 36s linear infinite}
@keyframes glowMove{0%{transform:translateY(0)}50%{transform:translateY(-88px)}100%{transform:translateY(0)}}

/* story scrollable content */
.story-content{position:relative;z-index:6;overflow:auto;height:100%;padding:28px 22px 18px 22px;-webkit-overflow-scrolling:touch}
.story-card{max-width:920px;margin:0 auto;background:linear-gradient(180deg, rgba(8,9,12,.36), rgba(6,7,9,.28));border-radius:12px;padding:28px;backdrop-filter: blur(8px);box-shadow:0 28px 90px rgba(0,0,0,.6);color:#eaeaf0;font-family:'Merriweather',serif;line-height:1.72;font-size:17px}
.story-card p{margin-bottom:14px}

/* SPOILER - atmos blur with soft edges (the one you liked) */
.spoiler{position:relative;display:inline-block;padding:12px 16px;border-radius:14px;background:linear-gradient(180deg, rgba(10,11,12,0.12), rgba(4,4,6,0.06));cursor:pointer;overflow:visible}
.spoiler .line{position:relative;z-index:6;color:transparent;transition:color .45s ease,text-shadow .45s ease}
.spoiler .beer-btn{position:relative;z-index:7;background:transparent;border:0;padding:0;margin:0;color:transparent;font:inherit;font-weight:700;cursor:pointer}
.spoiler .veil{position:absolute;inset:-14px;z-index:5;border-radius:18px;background:linear-gradient(120deg, rgba(18,20,24,0.96), rgba(8,9,12,0.99));backdrop-filter: blur(18px) saturate(.95);transition:transform .58s cubic-bezier(.2,.9,.3,1),opacity .58s;pointer-events:none;box-shadow: 0 8px 40px rgba(0,0,0,.6)}
/* soft fuzzy edge: pseudo-element with radial gradient */
.spoiler .veil::after{content:"";position:absolute;inset:-12px;border-radius:22px;background:radial-gradient(circle at 20% 20%, rgba(255,255,255,0.01), transparent 12%), radial-gradient(circle at 80% 80%, rgba(255,255,255,0.01), transparent 12%);filter:blur(6px);opacity:.12}
.spoiler.open .veil{transform:translateY(-160%);opacity:0}
.spoiler.open .line{color:#fff;text-shadow:0 10px 28px rgba(0,0,0,.58)}
.spoiler.open .beer-btn{color:#ffd166;text-decoration:underline}

/* ---------- FULLSCREEN BEER ANIMATION layer ---------- */
.beer-full{position:fixed;inset:0;z-index:3200;pointer-events:none;display:none;background:transparent;align-items:flex-start;justify-content:center}
.beer-full .beer-sprite{position:absolute;left:50%;top:-240px;width:min(36vw,180px);transform:translateX(-50%) rotate(0deg);will-change:transform,left,top}
.beer-full .puddle{position:absolute;left:50%;bottom:12vh;transform:translateX(-50%) scale(.2);width:26px;height:12px;border-radius:999px;background:radial-gradient(ellipse at 40% 30%, #fff3c7 0%, #ffd98a 28%, #b96820 78%);filter:blur(1.2px);box-shadow:0 12px 36px rgba(0,0,0,.45),inset 0 -6px 14px rgba(100,60,20,.44)}
.beer-full .splash{position:absolute;border-radius:50%;pointer-events:none;will-change:transform,opacity}

/* ---------- ROMANTIC VIDEO BACKGROUND (hidden until beer finishes) ---------- */
.bg-romantic{position:fixed;inset:0;z-index:-50;pointer-events:none;opacity:0;transition:opacity .8s ease}
.bg-romantic.active{opacity:1}
.bg-romantic video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;pointer-events:none}

/* ---------- MEME LAYER ---------- */
#memeLayer{position:fixed;inset:0;z-index:3300;pointer-events:none}
.meme-frame{position:absolute;padding:8px;border-radius:12px;background:linear-gradient(180deg,#24181f,#12070b);border:6px solid rgba(255,95,155,0.12);box-shadow:0 30px 110px rgba(0,0,0,.5);overflow:hidden;cursor:pointer;pointer-events:auto;transform-origin:center;will-change:transform;transition:opacity .36s ease}
.meme-frame img{width:100%;height:100%;object-fit:cover;display:block}
.fade-out{opacity:0 !important;transform:scale(.93) !important;transition:.42s ease}

/* ---------- CONFESSION PANEL ---------- */
#confessionPanel{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(var(--panel-w),920px);height:82vh;max-height:calc(100dvh - var(--safe-top) - var(--safe-bottom) - 40px);background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border-radius:18px;box-shadow:0 42px 160px rgba(0,0,0,.6);display:none;flex-direction:column;z-index:3400;padding:22px;overflow:hidden}
#confessionPanel.open{display:flex}
#confessionInner{overflow:auto;padding:12px;-webkit-overflow-scrolling:touch}
#confessionText{font-family:'Marck Script',cursive;font-size:clamp(28px,6.2vw,44px);text-align:center;color:#ffeaf2;text-shadow:0 10px 30px rgba(120,30,60,0.18)}
.confession-char{display:inline-block;white-space:pre;transform-origin:center bottom;animation:confJig 1.8s ease-in-out infinite}
@keyframes confJig{0%,100%{transform:translateY(0)}50%{transform:translateY(-3px)}}

/* heart button */
.heart-wrap{display:flex;flex-direction:column;align-items:center;margin-top:16px}
.heart-btn{font-size:62px;cursor:pointer;color:var(--accent);text-shadow:0 12px 30px rgba(255,79,125,.36);animation:heartPulse 1.6s ease-in-out infinite}
@keyframes heartPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.12)}}
.heart-caption{font-size:13px;color:#ffd8e6;margin-top:8px}

/* video overlay */
#videoOverlay{position:fixed;inset:0;z-index:3500;background:rgba(0,0,0,.94);display:none;align-items:center;justify-content:center;padding:max(12px,var(--safe-top))}
#videoOverlay video{width:94vw;max-width:900px;max-height:78vh;border-radius:12px;background:#000;box-shadow:0 22px 70px rgba(0,0,0,.6)}
.video-placeholder{display:flex;flex-direction:column;align-items:center;gap:8px;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));color:var(--soft)}

/* responsive tweaks */
@media (max-width:430px){
  #cat{width:min(88vw,420px)}
  .story-card{padding:20px;font-size:16px}
  #confessionText{font-size:clamp(26px,7.3vw,40px)}
  .meme-frame{width:clamp(120px,28vw,160px)}
}

/* Defensive: ensure decorative layers can't block the cat */
.bg-mystic, .bg-romantic, .beer-full, #memeLayer { pointer-events: none !important; }
.cat-frame, #cat { position: relative; z-index:2201 !important; pointer-events: auto !important; }

</style>
</head>
<body>

  <!-- mistic forest background (animated breathing + fog) -->
  <div class="bg-mystic" id="bgMystic">
    <div class="forest" aria-hidden="true"></div>
    <div class="fog f1" aria-hidden="true"></div>
    <div class="fog f2" aria-hidden="true"></div>
    <div class="fog f3" aria-hidden="true"></div>
  </div>

  <!-- intro cat -->
  <div class="intro-panel" id="introPanel" aria-label="–ù–∞—á–∞–ª–æ">
    <div class="cat-frame tap" id="catFrame" role="button" tabindex="0" aria-label="–ù–∞–∂–º–∏ –Ω–∞ –∫–æ—Ç–∏–∫–∞">
      <img id="cat" src="cat.jpg" alt="–∫–æ—Ç –ë—É—Å—è ‚Äî –Ω–∞–∂–º–∏" />
      <div class="hint">–Ω–∞–∂–º–∏ –Ω–∞ –∫–æ—Ç–∏–∫–∞ üêæ</div>
    </div>
  </div>

  <!-- story panel -->
  <div class="story-panel" id="storyPanel" role="dialog" aria-label="–†–∞—Å—Å–∫–∞–∑">
    <div class="story-bg" id="storyBg">
      <div class="glow" aria-hidden="true"></div>
    </div>
    <div class="story-content">
      <div class="story-card" id="storyCard">
        <!-- –ü–û–õ–ù–´–ô –†–ê–°–°–ö–ê–ó (–±—É–∫–≤–∞ –≤ –±—É–∫–≤—É) -->
        <p>–û–¥–Ω–∞–∂–¥—ã —è —Å–∏–¥–µ–ª –∫–∞–∫ –Ω–∏ –≤ —á—ë–º –Ω–µ –±—ã–≤–∞–ª–æ –¥–æ–º–∞, —Å–ª—É—à–∞–ª –≥—Ä—É—Å—Ç–Ω—É—é –º—É–∑—ã–∫—É, —Å–º–æ—Ç—Ä–µ–ª –≤ –æ–∫–Ω–æ, –¥—É–º–∞–ª –æ —Å–≤–æ—ë–º —Ç–ª–µ–Ω–Ω–æ–º –±—É–¥—É—â–µ–º, –∫–∞–∫ –≤–¥—Ä—É–≥‚Ä¶ –∑–≤–æ–Ω–æ–∫ –≤ –¥–≤–µ—Ä—å. –Ø –æ–ø–µ—à–∏–ª, –≤–µ–¥—å –±—ã–ª–æ 3 —á–∞—Å–∞ –Ω–æ—á–∏, –∏ —è –Ω–∏–∫–æ–≥–æ –Ω–µ –∂–¥–∞–ª. –í —Ç–æ—Ç –¥–µ–Ω—å –æ—â—É—â–µ–Ω–∏—è –ø–æ–∏—Å—Ç–∏–Ω–µ –±—ã–ª–∏ —Å—Ç—Ä–∞–Ω–Ω—ã–µ. –ù–∞ –¥–≤–æ—Ä–µ —Å—Ç–æ—è–ª–∞ –ª—ë–≥–∫–∞—è –¥—ã–º–∫–∞, –∞ –Ω–∞ –Ω–µ–±–µ –æ—Ç—á—ë—Ç–ª–∏–≤–æ –≤–∏–¥–Ω–µ–ª–∞—Å—å —è—Ä–∫–∞—è –ø–æ–ª–Ω–∞—è –ª—É–Ω–∞, –ø—Ä—è–º–æ –∫–∞–∫ —Å –∫–∞—Ä—Ç–∏–Ω–∫–∏ ‚Äî –º—Ä–∞—á–Ω–∞—è –∏ –∑–∞–≥–∞–¥–æ—á–Ω–∞—è. –ü–æ–≥–æ–¥–∞ –∑–∞ –æ–∫–Ω–æ–º –ª–∏—à—å –¥–æ–±–∞–≤–ª—è–ª–∞ —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω–æ–º—É —Å–æ–±—ã—Ç–∏—é.</p>

        <p>¬´–£ —Å–æ—Å–µ–¥–∞, –Ω–∞–≤–µ—Ä–Ω–æ–µ, —á—Ç–æ-—Ç–æ —Å—Ç—Ä—è—Å–ª–æ—Å—å¬ª, ‚Äî –ø–æ—á–µ—Å–∞–≤ —Ä–µ–ø—É, –ø–æ–¥—É–º–∞–ª —è. –ù–æ —á—É–≤—Å—Ç–≤–æ —Ç—Ä–µ–≤–æ–≥–∏ –∑–∞—Ç–º–∏–ª–æ –º–æ–π —Ä–∞—Å—Å—É–¥–æ–∫, –∏ —è –º–µ–¥–ª–µ–Ω–Ω–æ, —Ç–∏—Ö–∏–º —à–∞–≥–æ–º –ø–æ–¥–æ—à—ë–ª –∫ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏. –°—Ç–æ—è–ª–∞ –ø–æ–ª–Ω–µ–π—à–∞—è —Ç–∏—à–∏–Ω–∞. –Ø –ø—ã—Ç–∞–ª—Å—è –ø—Ä–∏—Å–ª—É—à–∞—Ç—å—Å—è –∫ –∑–≤—É–∫–∞–º –ø–æ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É –¥–≤–µ—Ä–∏, –Ω–æ –∏—Ö –Ω–µ –±—ã–ª–æ. –Ø —Å—Ç–æ—è–ª —Ç–∞–∫ –≥–¥–µ-—Ç–æ –º–∏–Ω—É—Ç—É, –Ω–æ –ø–æ –æ—â—É—â–µ–Ω–∏—è–º –æ–Ω–∞ –¥–ª–∏–ª–∞—Å—å —Ü–µ–ª—É—é –≤–µ—á–Ω–æ—Å—Ç—å. –í –≥–æ–ª–æ–≤–µ –±—ã–ª–∞ –ª–∏—à—å —Ä–∞—Å—Ç–µ—Ä—è–Ω–Ω–æ—Å—Ç—å –∏ —Å–º—è—Ç–µ–Ω–∏–µ.</p>

        <p>–ö–∞–∫ –≤–¥—Ä—É–≥ —è —É—Å–ª—ã—à–∞–ª —Å—Ç—Ä–∞–Ω–Ω—ã–π –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø, –±—É–¥—Ç–æ –∫—Ç–æ-—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ —É–≤–µ—Ä–µ–Ω–Ω–æ –≤–æ–¥–∏–ª –Ω–æ–≥—Ç–µ–º –ø–æ —Å—Ç–∞–ª—å–Ω–æ–º—É –ª–∏—Å—Ç—É. –Ø —Å–∏–ª—å–Ω–æ –Ω–∞–ø—Ä—è–≥—Å—è, –≤—Å—ë —Ç–µ–ª–æ —Å –≥–æ–ª–æ–≤—ã –¥–æ –Ω–æ–≥ –ø—Ä–æ–±—Ä–∞–ª–æ –º—É—Ä–∞—à–∫–∞–º–∏, —è –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª —Ä–µ–∑–∫–∏–π —Å–∫–∞—á–æ–∫ –∞–¥—Ä–µ–Ω–∞–ª–∏–Ω–∞ ‚Äî —Ä–∞–∑—É–º —è–≤–Ω–æ —á—É–≤—Å—Ç–≤–æ–≤–∞–ª, —á—Ç–æ —á—Ç–æ-—Ç–æ —Ç—É—Ç –Ω–µ —Ç–∞–∫. –Ø –Ω–∞–±—Ä–∞–ª—Å—è —Å–º–µ–ª–æ—Å—Ç–∏ –∏, —Å—Ü–µ–ø–∏–≤ –∑—É–±—ã, –≤—ã–¥–∞–≤–∏–ª –∏–∑ —Å–µ–±—è: ‚ÄûWer ist da?‚Äú –ù–æ, –∫–∞–∫ —è –∏ –æ–∂–∏–¥–∞–ª, –æ—Ç–≤–µ—Ç–∞ –Ω–µ –ø–æ—Å—Ç—É–ø–∏–ª–æ. –õ–∏—à—å —ç—Ç–æ—Ç –¥–æ –¥—Ä–æ–∂–∏ –ø—Ä–æ—Ç–∏–≤–Ω—ã–π –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –∑–≤—É–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–Ω–∏–∫–∞–ª –≤ –∫–∞–∂–¥—É—é –∫–ª–µ—Ç–æ—á–∫—É –º–æ–∑–≥–∞‚Ä¶ –û—â—É—â–∞–ª–æ—Å—å, –±—É–¥—Ç–æ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä—è–º–æ —É –º–µ–Ω—è –≤ –≥–æ–ª–æ–≤–µ, –±—É–¥—Ç–æ –∫—Ç–æ-—Ç–æ —Å –∏–∑–¥—ë–≤–∫–æ–π –≤–æ–¥–∏—Ç –ø–æ –Ω–µ–º—É —Å–∫—Ä–∏–ø—É—á–µ–π –∂–µ–ª–µ–∑—è–∫–æ–π.</p>

        <p>–ò –≤–¥—Ä—É–≥ ‚Äî —Ç–∏—à–∏–Ω–∞. –°–Ω–æ–≤–∞. –Ø –ø–æ–Ω–∏–º–∞–ª, —á—Ç–æ –∫—Ç–æ –±—ã —Ç–æ –Ω–∏ –±—ã–ª –∑–∞ –¥–≤–µ—Ä—å—é, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Ç–æ–∂–µ —É—Å–ª—ã—à–∞–ª, –∫–∞–∫ —è —Å—Ç–æ—é –∏ –º–æ–ª—á–∞ —Å–ª—É—à–∞—é, –≤–Ω–∏–º–∞—è —ç—Ç–æ—Ç –ø—Å–∏—Ö–æ–¥–µ–ª–∏—á–µ—Å–∫–∏–π —É–∂–∞—Å. –ì–¥–µ-—Ç–æ —Å–ø—É—Å—Ç—è —Å–µ–∫—É–Ω–¥ 20 —Ä–∞–∑–¥–∞–ª—Å—è –≥—Ä–æ–º–∫–∏–π –∂–µ–ª–µ–∑–Ω—ã–π –∑–≤—É–∫ ‚Äî –∑–≤—É–∫ –ø–∞–¥–µ–Ω–∏—è –ø—Ä—è–º–æ –ø–µ—Ä–µ–¥ –º–æ–µ–π –≥—Ä—ë–±–∞–Ω–Ω–æ–π –¥–≤–µ—Ä—å—é. –Ø –Ω–∞–±—Ä–∞–ª—Å—è —Å–º–µ–ª–æ—Å—Ç–∏ –∏ –ø—Ä–∏—Å–ª–æ–Ω–∏–ª —É—Ö–æ –∫ –¥–≤–µ—Ä–∏, —á—Ç–æ–±—ã –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –∂–µ —É–ø–∞–ª–æ... –∏ —á—Ç–æ, —á—ë—Ä—Ç –≤–æ–∑—å–º–∏, —Ç—É—Ç –≤–æ–æ–±—â–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.</p>

        <p>–ö–∞–∫ –≤–¥—Ä—É–≥, –∫–∞–∫ –≥—Ä–æ–º —Å—Ä–µ–¥–∏ —è—Å–Ω–æ–≥–æ –¥–Ω—è, –∫–∞–∫ —Å–Ω–µ–≥ –≤ –∏—é–ª–µ, —è —É—Å–ª—ã—à–∞–ª –Ω–µ–∂–Ω—ã–π, –º–∏–ª—ã–π –∏ –¥–æ –±–æ–ª–∏ –∑–Ω–∞–∫–æ–º—ã–π –∂–µ–Ω—Å–∫–∏–π –≥–æ–ª–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–µ—Å–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–∏–∑–Ω—ë—Å:</p>

        <div class="spoiler" id="finalSpoiler" role="button" tabindex="0" aria-pressed="false" aria-label="–û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω—á–ª–∞–π–Ω">
          <div class="veil" aria-hidden="true"></div>
          <div class="line">‚Äî –û–π, –∏–∑–≤–∏–Ω–∏, —É –º–µ–Ω—è <button class="beer-btn tap" id="beerWord" type="button" aria-label="–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞–¥–µ–Ω–∏–µ –ø–∏–≤–∞">–ø–∏–≤–æ</button> —É–ø–∞–ª–æ.</div>
        </div>

      </div>
    </div>
  </div>

  <!-- fullscreen beer animation container -->
  <div class="beer-full" id="beerFull" aria-hidden="true">
    <img id="beerFullSprite" class="beer-sprite" src="beer.png" alt="–±–∞–Ω–∫–∞ Desperados" />
    <div class="puddle" id="beerPuddle"></div>
  </div>

  <!-- romantic looping background (will play romance.mp4) -->
  <div class="bg-romantic" id="bgRomantic" aria-hidden="true">
    <video id="romanceVideo" src="romance.mp4" muted loop playsinline preload="auto" aria-hidden="true"></video>
  </div>

  <!-- meme layer -->
  <div id="memeLayer" aria-hidden="true"></div>

  <!-- confession panel -->
  <div id="confessionPanel" role="dialog" aria-label="–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ">
    <div id="confessionInner">
      <div id="confessionText" aria-live="polite">
        <!-- –ü–û–õ–ù–û–ï –ü–†–ò–ó–ù–ê–ù–ò–ï (–±—É–∫–≤–∞ –≤ –±—É–∫–≤—É) -->
        –±—É—Å—è, –∫–æ—Ç–∏–∫, —è –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª—Å—è —Å —Ç–æ–±–æ–π –ª–∏—à—å –º–µ—Å—è—Ü –Ω–∞–∑–∞–¥, –Ω–æ –≤–æ –º–Ω–µ —Ç–µ–ø–ª–∏—Ç—Å—è —á—É–≤—Å—Ç–≤–æ, –±—É–¥—Ç–æ —è –∑–Ω–∞–ª —Ç–µ–±—è –≤–æ –≤—Å–µ—Ö —Å–≤–æ–∏—Ö –ø—Ä–æ—à–ª—ã—Ö –∂–∏–∑–Ω—è—Ö, –≤–µ–¥—å –±–æ–ª–µ–µ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç—á–∞ –Ω–∞ –∑–µ–º–ª–µ –µ—â–µ –Ω–µ –±—ã–ª–æ. –∏ –Ω–µ –±—É–¥–µ—Ç. —Ç—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–∞—Ä–∏—à—å –º–Ω–µ —Ç—É —Å–∞–º—É—é —Ä–∞–¥–æ—Å—Ç—å –∏ —É–ª—ã–±–∫—É, –∫–æ—Ç–æ—Ä—ã—Ö —É –º–µ–Ω—è –æ—á–µ–Ω—å –¥–∞–≤–Ω–æ –Ω–µ –±—ã–ª–æ. –ø–æ–ª–≥–æ–¥–∞ –Ω–∞–∑–∞–¥ —è –∏ –Ω–µ –¥—É–º–∞–ª, —á—Ç–æ —Å–º–æ–≥—É –ø–æ–ª—é–±–∏—Ç—å –∫–æ–≥–æ-—Ç–æ —Ç–∞–∫ —Å–∏–ª—å–Ω–æ –∫–∞–∫ —Ç–µ–±—è. –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –∂–¥—É –Ω–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–∏, —è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Ü–µ–ª—É—é —Ç–µ–±—è –ø–æ–¥ –ø—Ä–∏–ø–µ–≤ —ç—Ç–æ–π –ø–µ—Å–Ω–∏
      </div>

      <div class="heart-wrap">
        <div class="heart-btn tap" id="heartBtn" role="button" tabindex="0">üíò</div>
        <div class="heart-caption">—Å–µ—Ä–¥–µ—á–∫–æ —Ç—ã–∫</div>
      </div>
    </div>
    <button id="closeConfession" class="close-btn tap" style="position:absolute;right:12px;top:12px">‚úï</button>
  </div>

  <!-- video overlay (for heart click) -->
  <div id="videoOverlay" role="dialog" aria-hidden="true" style="display:none;align-items:center;justify-content:center;">
    <video id="secretVideo" src="video.mp4" controls playsinline webkit-playsinline preload="metadata" style="display:none"></video>
    <div class="video-placeholder" id="videoPlaceholder" style="display:flex">
      <div style="font-size:44px">üé¨</div>
      <div>–í–∏–¥–µ–æ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –∑–¥–µ—Å—å.</div>
      <div style="opacity:.78;font-size:13px;margin-top:6px">–ü–æ–∫–∞ —á—Ç–æ –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ñ–∏–Ω–∞–ª–∞ üíù</div>
    </div>
  </div>

  <!-- audio elements (beer sfx) -->
  <audio id="beerSfx" src="beer-sfx.mp3" preload="auto"></audio>
  <audio id="darkMusic" src="dark.mp3" preload="auto"></audio>
  <audio id="loveMusic" src="love.mp3" preload="auto"></audio>

<script>
/* ============================
   Main logic implementing user's flow:
   - Cat click: hide intro -> show story panel (forest bg lives behind)
   - Spoiler: opened via click (veil moves away)
   - Beer button: play beer-sfx, hide story text, run fullscreen beer fall animation
   - After beer animation completes: play romance.mp4 loop (bgRomantic) + spawn memes
   - Clicking a meme: remove everything except bgRomantic and show confession (animated letters)
   - Heart: pulsating; on click opens final video overlay
   Notes: put assets in repo root with exact filenames (see message).
============================*/

/* helpers */
const $ = s => document.querySelector(s)
const $$ = s => Array.from(document.querySelectorAll(s))
const clamp = (v,a,b) => Math.max(a,Math.min(b,v))

/* elements */
const introPanel = $('#introPanel')
const catFrame = $('#catFrame')
const storyPanel = $('#storyPanel')
const storyCard = $('#storyCard')
const finalSpoiler = $('#finalSpoiler')
const beerWord = $('#beerWord')
const beerFull = $('#beerFull')
const beerFullSprite = $('#beerFullSprite')
const beerPuddle = $('#beerPuddle')
const bgRomantic = $('#bgRomantic')
const romanceVideo = $('#romanceVideo')
const memeLayer = $('#memeLayer')
const confessionPanel = $('#confessionPanel')
const confessionText = $('#confessionText')
const heartBtn = $('#heartBtn')
const videoOverlay = $('#videoOverlay')
const secretVideo = $('#secretVideo')
const videoPlaceholder = $('#videoPlaceholder')
const beerSfx = $('#beerSfx')
const darkMusic = $('#darkMusic')
const loveMusic = $('#loveMusic')

/* state flags */
let audioUnlocked = false
let beerAnimating = false
let romanceStarted = false

/* unlock audio on first user gesture (mobile browsers) */
function unlockAudio(){
  if(audioUnlocked) return
  audioUnlocked = true
  try{
    // prime audio elements so they can play later
    [beerSfx,darkMusic,loveMusic,romanceVideo].forEach(a=>{
      if(!a) return
      a.volume = 0
      const p = a.play && a.play()
      if(p && p.catch) p.catch(()=>{})
      if(a.pause) a.pause && a.pause()
      a.currentTime = 0
    })
  }catch(e){}
}
window.addEventListener('click', unlockAudio, {once:true})
window.addEventListener('touchstart', unlockAudio, {once:true,passive:true})

/* open story: hide cat intro and open story panel */
function openStory(){
  introPanel.classList.add('hidden')
  setTimeout(()=> introPanel.style.display='none', 420)
  storyPanel.classList.add('open')
  // start subtle music if available
  try{ darkMusic.currentTime = 0; darkMusic.volume = 0; darkMusic.play().catch(()=>{}); fadeTo(darkMusic, 0.14, 900) }catch(e){}
}
catFrame.addEventListener('click', openStory)
catFrame.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); openStory() }})

/* Reveal spoiler (veil) when clicking away or pressing) */
finalSpoiler.addEventListener('click', (ev)=>{
  // if clicked beer button, beerWord handler will handle
  if(ev.target && ev.target.closest && ev.target.closest('.beer-btn')) return
  finalSpoiler.classList.add('open')
  finalSpoiler.setAttribute('aria-pressed','true')
})
finalSpoiler.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); finalSpoiler.click() }})

/* small fade helper for audio */
function fadeTo(audio, target=0.2, ms=900){
  if(!audio) return
  const start = audio.volume || 0
  const startT = performance.now()
  function step(now){
    const k = Math.min(1, (now - startT)/ms)
    audio.volume = start + (target - start) * k
    if(k < 1) requestAnimationFrame(step)
  }
  requestAnimationFrame(step)
}

/* ---------- BEER animation + sequence ----------
   - when beerWord clicked: reveal spoiler (if needed), play beerSfx,
     hide storyCard content (fade out), then show beerFull layer and run fall animation,
     spawn splashes and puddle,
     after puddle animation finishes -> start romance background + spawn memes
*/
beerWord.addEventListener('click', (ev)=>{
  ev.preventDefault(); ev.stopPropagation()
  finalSpoiler.classList.add('open')
  finalSpoiler.setAttribute('aria-pressed','true')
  // ensure audio unlocked
  unlockAudio()
  try{ beerSfx.currentTime = 0; beerSfx.play().catch(()=>{}); }catch(e){}
  // start sequence
  startBeerSequence()
})
beerWord.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); beerWord.click() }})

/* helper to fade out story content */
function hideStoryContent(){
  // fade out the story card quickly
  storyCard.animate([{opacity:1},{opacity:0}], {duration:380, fill:'forwards', easing:'ease-out'})
  setTimeout(()=>{ try{ storyCard.style.display='none' }catch(_){} }, 420)
}

/* spawn splashes helper */
function spawnSplash(cx, cy, qty=28){
  for(let i=0;i<qty;i++){
    const d = document.createElement('div'); d.className='splash'
    const size = (i<4 ? 18 + Math.random()*14 : 6 + Math.random()*12)
    d.style.width = d.style.height = size + 'px'
    d.style.left = (cx - size/2) + 'px'
    d.style.top = (cy - size/2) + 'px'
    d.style.zIndex = 3400
    d.style.background = 'radial-gradient(circle, rgba(255,240,160,.98), rgba(255,190,80,.8) 56%, rgba(255,150,50,0) 100%)'
    document.body.appendChild(d)
    const dx = (Math.random()*520)-260; const dy = -(80 + Math.random()*160)
    const rot = Math.random()*360-180; const dur = 820 + Math.random()*680
    d.animate([{transform:'translate(0,0) scale(.6)',opacity:1},{transform:`translate(${dx}px, ${dy}px) rotate(${rot}deg) scale(1)`,opacity:1},{transform:`translate(${dx*1.1}px, ${dy+260}px) rotate(${rot*1.05}deg) scale(.28)`,opacity:0}], {duration:dur, easing:'cubic-bezier(.2,.9,.2,1)', fill:'forwards'})
    setTimeout(()=>d.remove(), dur + 120)
  }
}
function spawnFoam(cx, cy, qty=12){
  for(let i=0;i<qty;i++){
    const f = document.createElement('div'); f.className='splash'
    const size = 4 + Math.random()*9
    f.style.width = f.style.height = size + 'px'
    f.style.left = (cx + (Math.random()*80-40)) + 'px'
    f.style.top = (cy + (Math.random()*20-10)) + 'px'
    f.style.background = 'radial-gradient(circle, rgba(255,255,255,.9), rgba(255,255,255,0))'
    document.body.appendChild(f)
    const dur = 1000 + Math.random()*800
    f.animate([{transform:'translateY(0)',opacity:.86},{transform:`translateY(${-18 - Math.random()*26}px)`,opacity:0}], {duration:dur, easing:'ease-out', fill:'forwards'})
    setTimeout(()=>f.remove(), dur + 80)
  }
}

/* physics-style fall for beer: vertical drop with bounces (simplified) */
function startBeerSequence(){
  if(beerAnimating) return
  beerAnimating = true
  hideStoryContent()
  setTimeout(()=>{ // small delay for fade
    // show full screen beer container
    beerFull.style.display = 'flex'
    beerFull.style.pointerEvents = 'none'
    // position beer at top center with small random horizontal offset
    const startX = window.innerWidth * (0.5 + (Math.random()*0.06 - 0.03))
    beerFullSprite.style.left = startX + 'px'
    beerFullSprite.style.top = '-320px'
    beerFullSprite.style.display = 'block'
    beerFullSprite.style.transform = `translateX(-50%) rotate(${(Math.random()*16-8)}deg)`
    // run physics simulation
    const state = { x: startX, y: -320, vx: (Math.random()*240 - 120), vy: 0, angle: (Math.random()*28 - 14), av: (Math.random()*320 - 160) }
    const gravity = 3200, drag = 0.997
    const floorY = Math.round(window.innerHeight * 0.72)
    const fixedDt = 1/120
    let prev = performance.now(), acc = 0, bounces = 0

    function step(){
      state.vy += gravity * fixedDt
      state.vx *= drag
      state.x += state.vx * fixedDt
      state.y += state.vy * fixedDt
      state.angle += state.av * fixedDt
      state.av *= 0.995
      if(state.y >= floorY){
        state.y = floorY
        if(bounces < 2){
          state.vy *= -(0.32 + Math.random()*0.14)
          state.vx *= 0.72
          state.av *= -0.44
          bounces++
        } else {
          state.vy = 0
          state.vx *= 0.94
          state.av *= 0.92
          state.angle *= 0.985
        }
      }
    }
    function render(){
      beerFullSprite.style.left = state.x + 'px'
      beerFullSprite.style.top = state.y + 'px'
      beerFullSprite.style.transform = `translateX(-50%) rotate(${state.angle}deg)`
    }
    function loop(now){
      let dt = (now - prev)/1000
      if(dt > .05) dt = .05
      prev = now
      acc += dt
      while(acc >= fixedDt){ step(); acc -= fixedDt }
      render()
      if(!(bounces >= 2 && Math.abs(state.vy) < 18 && state.y >= floorY)){
        requestAnimationFrame(loop)
      } else {
        // impact
        try{ navigator.vibrate && navigator.vibrate([80,30,80]) }catch(e){}
        spawnSplash(state.x, floorY + 26, 32)
        spawnFoam(state.x, floorY + 20, 12)
        // show puddle animation
        const maxW = Math.max(340, Math.min(window.innerWidth * 0.7, 900))
        const maxH = Math.max(64, Math.min(window.innerWidth * 0.14, 110))
        beerPuddle.style.display = 'block'
        beerPuddle.animate([{opacity:0, width:'26px', height:'10px', transform:'translateX(-50%) scale(.22,.24) rotateX(16deg)'},{opacity:1, width: maxW + 'px', height: maxH + 'px', transform:'translateX(-50%) scale(1,.78) rotateX(16deg)'}], {duration:980, easing:'cubic-bezier(.2,.8,.2,1)', fill:'forwards'})
        // ripple (visual)
        // cleanup puddle later
        setTimeout(()=>{ beerPuddle.animate([{opacity:1, transform:'translateX(-50%) scale(1,.78)'},{opacity:0, transform:'translateX(-50%) scale(.5,.2) translateY(6px)'}], {duration:1200, easing:'ease-in-out', fill:'forwards'}); }, 3800)
        // switch to romance after short delay so puddle effect noticed
        setTimeout(()=> finishBeerAndStartRomance(), 1400)
      }
    }
    requestAnimationFrame(loop)
  }, 420)
}

/* When beer animation finished -> play romance video background, show memes */
function finishBeerAndStartRomance(){
  // hide beer full-screen after a bit (we left a puddle but we now transition)
  setTimeout(()=>{ beerFull.style.display = 'none'; beerFullSprite.style.display='none'; beerPuddle.style.display='none' }, 420)
  // fade darkMusic out and start loveMusic (if any)
  try{ fadeTo(darkMusic, 0, 600); setTimeout(()=>{ try{ darkMusic.pause(); darkMusic.currentTime = 0 }catch(_){} }, 700) }catch(e){}
  // show romantic bg (video)
  bgRomantic = document.getElementById('bgRomantic')
  bgRomantic.classList.add('active')
  try{ romanceVideo.currentTime = 0; romanceVideo.play().catch(()=>{}); }catch(e){}
  romanceStarted = true
  // spawn many meme images
  spawnMemes(20)
}

/* spawn memes (many clones of meme.png) */
function spawnMemes(count = 20){
  memeLayer.innerHTML = ''
  memeLayer.style.pointerEvents = 'auto'
  const items = []
  for(let i=0;i<count;i++){
    const frame = document.createElement('div'); frame.className = 'meme-frame'
    const size = 100 + Math.random()*260
    frame.style.width = size + 'px'; frame.style.height = size + 'px'
    const left = clamp(4 + Math.random()*86, 2, 92)
    const top = clamp(6 + Math.random()*80, 4, 92)
    frame.style.left = left + '%'; frame.style.top = top + '%'
    const img = document.createElement('img'); img.src = 'meme.png'; img.alt = '–º–µ–º'
    frame.appendChild(img)
    memeLayer.appendChild(frame)
    items.push({el:frame,left,top,w:size,h:size})
  }

  // apply gentle drifting + random rotation
  items.forEach(it=>{
    const dur = 2600 + Math.random()*5200
    const rx = (Math.random()*40-20), ry = (Math.random()*40-20), rz = (Math.random()*120-60)
    it.el.animate([
      { transform: `translate3d(0,0,0) rotateX(${rx}deg) rotateY(${ry}deg) rotateZ(${rz}deg)` },
      { transform: `translate3d(${(Math.random()*60-30).toFixed(1)}px,${(Math.random()*-40-20).toFixed(1)}px,0) rotateX(${(rx*1.1).toFixed(1)}deg) rotateY(${(ry*1.1).toFixed(1)}deg) rotateZ(${(rz+7).toFixed(1)}deg)` },
      { transform: `translate3d(${(Math.random()*-40).toFixed(1)}px,${(Math.random()*-10).toFixed(1)}px,0) rotateX(${(rx*0.9).toFixed(1)}deg) rotateY(${(ry*0.9).toFixed(1)}deg) rotateZ(${(rz-9).toFixed(1)}deg)` },
      { transform: `translate3d(0,0,0) rotateX(${rx}deg) rotateY(${ry}deg) rotateZ(${rz}deg)` }
    ], { duration: dur, iterations: Infinity, easing: 'ease-in-out' })

    it.el.addEventListener('click', ()=>{
      // On clicking one meme: remove memes and show confession only (bg remains)
      $$('.meme-frame').forEach(m=> m.classList.add('fade-out'))
      setTimeout(()=>{ memeLayer.innerHTML = ''; showConfession() }, 420)
    }, {once:true})
  })
}

/* show confession: clear overlays except romance bg and show confession panel */
function showConfession(){
  // hide story panel if still open
  storyPanel.classList.remove('open')
  // ensure romance bg is active
  document.querySelector('.bg-romantic')?.classList.add('active')
  // animate confession text letters
  animateConfessionText()
  confessionPanel.classList.add('open')
}

/* animate confession text into per-char spans with small jiggle */
function animateConfessionText(){
  const raw = confessionText.textContent.trim()
  const segments = raw.match(/[^.!?]+[.!?]?/g)?.map(s=>s.trim()).filter(Boolean) || [raw]
  confessionText.innerHTML = ''
  segments.forEach((seg, idx)=>{
    const p = document.createElement('p')
    for(let i=0;i<seg.length;i++){
      const ch = seg[i]
      const span = document.createElement('span'); span.className = 'confession-char'
      span.textContent = (ch === ' ') ? '\u00A0' : ch
      // tiny random phase to avoid synchronized jiggle
      span.style.animationDelay = (Math.random()*0.4) + 's'
      p.appendChild(span)
    }
    confessionText.appendChild(p)
    setTimeout(()=>{ p.style.opacity = 1 }, 220 + idx*220)
  })
}

/* heart -> open secret video */
heartBtn.addEventListener('click', ()=>{
  videoOverlay.style.display = 'flex'
  videoOverlay.setAttribute('aria-hidden','false')
  videoPlaceholder.style.display = 'none'
  secretVideo.style.display = 'block'
  secretVideo.play().catch(()=>{ secretVideo.style.display='none'; videoPlaceholder.style.display='flex' })
})
heartBtn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); heartBtn.click() } })
videoOverlay.addEventListener('click', (e)=>{ if(e.target === videoOverlay){ videoOverlay.style.display='none'; try{ secretVideo.pause() }catch(_){} } })
secretVideo.addEventListener('error', ()=>{ secretVideo.style.display='none'; videoPlaceholder.style.display='flex' })

/* close confession (small close button) */
$('#closeConfession').addEventListener('click', ()=> confessionPanel.classList.remove('open'))

/* ESC to close overlays */
document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape'){ confessionPanel.classList.remove('open'); videoOverlay.style.display = 'none' } })

/* tiny safety: if cat is not clickable because of accidental overlays, pointer-capture fallback */
function pointerCaptureHandler(e){
  try{
    const r = catFrame.getBoundingClientRect()
    const x = (typeof e.clientX === 'number') ? e.clientX : (e.touches && e.touches[0] && e.touches[0].clientX) || -1
    const y = (typeof e.clientY === 'number') ? e.clientY : (e.touches && e.touches[0] && e.touches[0].clientY) || -1
    if(x >= r.left && x <= r.right && y >= r.top && y <= r.bottom){
      e.preventDefault && e.preventDefault(); e.stopPropagation && e.stopPropagation(); openStory()
    }
  }catch(_){}
}
document.addEventListener('pointerdown', pointerCaptureHandler, {capture:true, passive:false})
document.addEventListener('touchstart', pointerCaptureHandler, {capture:true, passive:false})

/* expose debug helpers */
window._gift = { openStory, startBeerSequence, spawnMemes, showConfession }
</script>
</body>
</html>
